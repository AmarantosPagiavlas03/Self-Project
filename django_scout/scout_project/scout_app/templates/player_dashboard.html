<!DOCTYPE html>
<html>
<head>
    <title>Player Dashboard</title>
    {% load static %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'styles.css' %}">
</head>
<body>
    {% include 'navbar.html' %}
    <div class="card_container">
 
            <div class="card_container__wrapper"> 
                <!-- Profile Card -->
                <div class="card_container__row">
                    <div class="card_container__column">
                        <div class="card_dashboard card_dashboard__main_card">
                            <div class="card-body text-center p-4">
                                <h2>Player Profile</h2>
                                <p>Welcome Player, {{ profile.first_name }} {{ profile.last_name }}</p>
                                {% if profile.user == request.user %}
                                    <a href="{% url 'edit_profile' %}" class="btn btn-primary">Edit Profile</a>
                                {% endif %}
                                <a href="{% url 'view_profile' %}" class="btn btn-primary">View Full Profile</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="card_container__row">
                    <!-- Performance Card -->
                    <div class="card_container__column">
                        <div class="card_dashboard">
                            <div class="card_dashboard__only">
                                <h5 class="card-title">Performance</h5>
                                <p>Check your stats and progress</p>
                                <a href="{% url 'statistics' %}" class="btn btn-primary">View Stats</a>
                            </div>
                        </div>
                    </div>

                    <!-- Match History Card -->
                    <div class="card_container__column">
                        <div class="card_dashboard">
                            <div class="card_dashboard__only">
                                <h5 class="card-title">Recent Matches</h5>
                                <p>Review your last matches</p>
                                <a href="#" class="btn btn-primary">View History</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Upcoming Events and News Cards -->
                <div class="card_container__row"> 
                    <!-- Training Card -->
                    <div class="card_container__column">
                        <div class="card_dashboard">
                            <div class="card_dashboard__only">
                                <h5 class="card-title">Upcoming Events</h5>
                                <p>Trainings and fixtures</p>
                                <a href="#" class="btn btn-primary">View Schedule</a>
                            </div>
                        </div>
                    </div>

                    <!-- News Card -->
                    <div class="card_container__column">
                        <div class="card_dashboard">
                            <div class="card_dashboard__only">
                                <h5 class="card-title">Latest News</h5>
                                <p>Stay updated with team news</p>
                                <a href="#" class="btn btn-primary">Read More</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Overview and Statistics Barplot Cards -->
                <div class="card_container__row"> 
                    <div class="card_container__column">
                        <div class="card_dashboard">
                            <div class="card_dashboard__chart_container"> 
                                <h5 class="card-title">Performance Overview</h5>
                                <canvas id="performanceChart" width="300" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="card_container__column">
                        <div class="card_dashboard">
                            <div class="card_dashboard__chart_container"> 
                                <h5 class="card-title">Statistics Barplot</h5>
                                <canvas id="performanceBarPlot" width="300" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
 
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Radar Chart - Performance Overview
            const labels = JSON.parse('{{ performance_data.labels|escapejs }}');
            const data = JSON.parse('{{ performance_data.data|escapejs }}');
    
            if (data.length === 0) {
                document.querySelector('.chartContainer').innerHTML = '<h5 class="card-title">Performance Overview</h5><p>No data available</p>';
            } else {
                const ctx = document.getElementById('performanceChart').getContext('2d');
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Performance Metrics',
                            data: data,
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            pointBackgroundColor: 'rgb(75, 192, 192)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(75, 192, 192)'
                        }]
                    },
                    options: {
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            r: {
                                min: 0,
                                max: 4,
                                ticks: {
                                    stepSize: 1,
                                    backdropColor: "transparent"
                                }
                            }
                        }
                    }
                });
            }
        });
    </script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Bar Chart - Performance Statistics
            const bar_plot_labels = JSON.parse('{{ bar_plot_data.labels|escapejs }}');
            const bar_plot_data = JSON.parse('{{ bar_plot_data.data|escapejs }}');
    
            if (bar_plot_data.length === 0) {
                document.querySelector('.chartContainer').innerHTML = '<h5 class="card-title">Performance Overview</h5><p>No data available</p>';
            } else {
                const barCtx = document.getElementById('performanceBarPlot').getContext('2d');
                new Chart(barCtx, {
                    type: 'bar',
                    data: {
                        labels: bar_plot_labels,
                        datasets: [{
                            label: 'Performance Stats',
                            data: bar_plot_data,
                            backgroundColor: 'rgba(54, 162, 235, 0.5)',
                            borderColor: 'rgb(54, 162, 235)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                min: 0,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>